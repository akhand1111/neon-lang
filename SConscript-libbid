import os
import sys
import tarfile

Import("env")

if not os.path.exists("external/IntelRDFPMathLib20U1/LIBRARY/makefile.mak"):
    tarfile.open("external/IntelRDFPMathLib20U1.tar.gz").extractall("external")
if sys.platform == "win32":
    libbid = env.Command("external/IntelRDFPMathLib20U1/LIBRARY/libbid.lib", "external/IntelRDFPMathLib20U1/LIBRARY/makefile.mak", "cd external/IntelRDFPMathLib20U1/LIBRARY && nmake -fmakefile.mak CC=cl GLOBAL_RND=1 GLOBAL_FLAGS=1")
else:
    libbid = env.Command("external/IntelRDFPMathLib20U1/LIBRARY/libbid.a", "external/IntelRDFPMathLib20U1/LIBRARY/makefile.mak", "cd external/IntelRDFPMathLib20U1/LIBRARY && make CC=gcc GLOBAL_RND=1 GLOBAL_FLAGS=1")

env.Append(CPPPATH=["external/IntelRDFPMathLib20U1/LIBRARY/src"])

Return(["libbid"])
